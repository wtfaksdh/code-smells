# Lab6TP  
Лабораторная работа №6: Рефакторинг и устранение Code Smells

## Описание проекта

В рамках лабораторной работы выполнен рефакторинг модуля обработки заказов `order_processing.py`.  
Исходный код реализовывал расчёт стоимости заказа с учётом скидок и налогов, однако содержал ряд проблем качества кода (code smells), ухудшающих читаемость и поддерживаемость.  
Целью рефакторинга было улучшение структуры кода без изменения его внешнего поведения.  
Корректность работы подтверждена автоматическими тестами.

---

## Обнаруженные проблемы качества кода

### 1. Длинная функция (Long Method)

Функция `process_checkout()` была слишком длинной и выполняла несколько различных задач:

- разбор входного запроса;
- валидация данных;
- расчёт промежуточной суммы заказа;
- применение скидок;
- расчёт налога;
- формирование итогового ответа.

Это нарушало принцип единственной ответственности (SRP).

---

### 2. Магические числа (Magic Numbers)

В исходном коде использовались неименованные числовые и строковые константы:

- проценты скидок: `0.10`, `0.20`, `0.05`;
- процент налога: `0.21`;
- пороговые значения: `200`, `100`;
- фиксированные значения скидок: `50`, `10`;
- строковые литералы: `"USD"`, `"SAVE10"`, `"SAVE20"`, `"VIP"`.

Использование магических чисел затрудняло понимание бизнес-логики.

---

### 3. Сложные условные конструкции (Complex Conditionals)

Логика обработки купонов представляла собой большой блок `if / elif` с вложенными условиями.  
Это усложняло чтение кода и увеличивало риск ошибок при добавлении новых купонов.

---

### 4. Смешение уровней абстракции

Функция `process_checkout()` одновременно работала с:

- низкоуровневой проверкой данных;
- бизнес-логикой расчётов;
- формированием структуры результата.

Это снижало читаемость кода и усложняло его модификацию.

---

## Применённые рефакторинги

### 1. Вынесение констант (Extract Constants)

Все числовые и строковые значения были вынесены в именованные константы.

```python
# Было:
discount = int(subtotal * 0.10)
currency = "USD"

# Стало:
DISCOUNT_SAVE10 = 0.10
DEFAULT_CURRENCY = "USD"
discount = int(subtotal * DISCOUNT_SAVE10)
currency = DEFAULT_CURRENCY
```
discount = int(subtotal * 0.10)
currency = "USD"
